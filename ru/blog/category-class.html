<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Класс Категории - Блог - Декларативный Node.js фреймворк Evado</title>
  <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico">
  <link rel="stylesheet" href="../../vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../vendor/highlight/styles/default.css">
  <link rel="stylesheet" href="../../css/common.css">
</head>

<body>
<div class="wrapper">
  <nav class="navbar navbar-inverse navbar-target"></nav>

  <article class="container">
    <div class="row">
      <div class="col-md-9">
        <h1>Класс Категории</h1>
        <p>
          Вернитесь в Студию и создайте класс <code>category</code> (Категория).
          В нем будут содержаться ссылки на статьи определенной тематики.
        </p>
        <p>
          Создайте атрибут <code>name</code> (Название) с типом Строка. Он будет хранит название категории.
          Установите флажки <b>Обязательный</b> и <b>Уникальный</b>.
          Перейдите на вкладку <b>Поиск</b> и установите флажки <b>Общий поисковый</b>
          и <b>Поисковый в списке выбора</b> для участия атрибута в поиске среди объектов класса.
        </p>
        <p>
          Далее необходимо связать статьи и категории. Одна статья может быть размещена в нескольких категориях.
          Перейдите в класс статьи и создайте атрибут <code>categories</code> (Категории) c типом Ссылочный.
          Установите флажок <b>Множественная связь</b>.
        </p>
        <p>
          Перейдите в класс Категория и создайте атрибут <code>publicArticles</code> (Публичные статьи) с типом Обратная ссылка.
          В поле Ссылочный класс выберите класс Статья, а в поле Ссылочный атрибут выберите атрибут Категории.
          Установите флажки <b>Множественная связь</b> и <b>Только чтение</b>.
          Нельзя добавлять и убирать статьи через данный атрибут, только через управлением категориями из самой статьи.
        </p>
        <p>
          Сейчас в атрибуте Публичные статьи отображаются все статьи, имеющие данную категорию.
          Чтобы отфильтровать статьи необходимо создать представление класса.
          Представление переопределяет параметры класса.
          Например, представление <code>list</code> может отобразить только некоторые атрибуты при выводе объектов в списке.
          Представление <code>create</code> может добавить валидаторы при создании объекта.
          Представление <code>edit</code> может запретить изменение некоторых атрибутов при редактировании объекта.
        </p>
        <p>
          Откройте класс Статья и перейдите на вкладку <b>Представления</b>.
          Создайте представление <code>publicList</code> (Публичный список).
          В полe <b>Фильтр</b> укажите условие отбора статей <code>{"status":"published"}</code>
          В данном представлении будут отображаться только статьи, имеющие статус <b>Опубликовано</b>.
        </p>
        <p>
          Сохраните представление. Затем перейдите на появившуюся вкладку <b>Атрибуты</b>
          и добавьте атрибуты, которые должны быть в представлении.
        </p>
        <p>
          Перейдите в класс Категория и откройте атрибут <b>Публичные статьи</b>.
          Перейдите на вкладку <b>Отношение</b>.
          В поле <b>Представление списка</b> выберите представление <b>Публичный список</b>.
        </p>
        <p>
          Перейдите в класс Категория и создайте атрибут <code>publicArticleCounter</code> (Счетчик публичных статей)
          с типом <b>Вычисляемый</b>. В поле <b>Выражение</b> задайте алгоритм вычисления (подробнее смотри в
          <a href="https://github.com/mkhorin/evado-meta-base/blob/master/calc/Calc.js" target="_blank">Calc</a>):
        </p>
        <pre class="code"></pre>
        <div class="alert-warning alert">
          Вычисляемый атрибут не хранится в базе данных, а вычисляется при каждом запросе.
          Это влияет на производительность и налагает некоторые ограничения при поиске и выборках.
        </div>
        <p>
          Экспортируйте метаданные и перейдите в Офис. Создайте объекты категорий и статей.
          Добавьте категорию в статью.
          Измените статус статьи и проверьте как изменился список публичных статей в категории.
        </p>
      </div>
    </div>
  </article>

</div>
<footer class="footer footer-inverse">
  <div class="container mt20">
    <p class="text-center">Copyright @ 2022 Maxim Khorin</p>
  </div>
</footer>

<script src="../../vendor/jquery/jquery.min.js"></script>
<script src="../../vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../../vendor/highlight/highlight.pack.js"></script>
<script src="../../js/blog.js"></script>
<script src="../../js/common-ru.js"></script>
<script src="../../js/common.js"></script>

</body>
</html>