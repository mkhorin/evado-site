<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Бизнес-процесс - Блог - Декларативный Node.js фреймворк Evado</title>
  <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico">
  <link rel="stylesheet" href="../../vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../vendor/highlight/styles/default.css">
  <link rel="stylesheet" href="../../css/common.css">
</head>

<body>
<div class="wrapper">
  <nav class="navbar navbar-inverse navbar-target"></nav>

  <article class="container">
    <div class="row">
      <div class="col-md-9">
        <h1>Бизнес-процесс</h1>
        <p>
          В приложении часто требуется, чтобы отдельный объект класса мог находиться в особом состоянии,
          отличающем его от других. В общем случае это делается с помощью явно задаваемых значений.
          Например, в классе статья есть атрибут Статус.
          Этого достаточно для поиска и фильтрации,
          но недостаточно для использовани специальных представлений и прав доступа.
        </p>
        <p>
          Бизнес-процесс создает структуру управления состояниями объектов.
          Элемент <b>Состояние</b> определяет возможное состояние объекта класса.
          Каждый объект хранит служебный атрибут <code>_state</code>, определяющий его текущее состояние.
          <b>Переход</b> - это правило изменения состояния.
          Переход позволяет задать условие при котором возможно изменить одно состояние на другое.
        </p>
        <div class="alert-warning alert">
          Чтобы получит доступ к служебным атрибутам, создайте атрибуты класса с такими же именами.
          Например, <code>_state</code>, <code>_createdAt</code>, <code>_updateAt</code>.
          Значение служебного атрибута сохраняется в объекте вне зависимости от наличия метаданных.
        </div>
        <p>
          Откройте класс Комментарий и создайте атрибут <code>_state</code> с типом Строка.
          Установите флажок <b>Только чтение</b>.
          Выберите тип представления - <b>Состояние</b>,
          чтобы отображался ярлык состояния, а не просто его кодовое имя.
        </p>
        <p>
          Откройте класс Комментарий и выберите вкладку <b>Состояния</b>.
          Создайте состояние <code>hidden</code> (Скрытое).
          В этом состоянии комментарии не будут отображаться в публичной части сайта.
          Установите флажок <b>Режим объекта только для чтения</b>.
          Пользователь не сможет изменить комментарий, пока он находится в данном состоянии.
        </p>
        <p>
          Создайте состояние <code>pending</code> (Ожидание).
          В этом состоянии будут комментарии ожидающие модерации.
        </p>
        <p>
          Создайте состояние <code>published</code> (Опубликовано).
          В этом состоянии будут опубликованные комментарии.
          Установите флажок <b>Режим объекта только для чтения</b>.
        </p>
        <p>
          На вкладке <b>Переходы</b> создайте переход <code>publish</code> (Публиковать).
          В поле <b>Начальные состояние</b> добавьте Скрытое и Ожидание.
          Это определяет из каких состояний объекта возможен данный переход.
          В поле <b>Конечное состояние</b> выберите Опубликовано.
          Это определяет результат перехода - новое состояние объекта.
        </p>
        <div class="alert-warning alert">
          Используйте глаголы в качестве кодовых имен переходов.
          Это подчеркивает воздействие перехода на состояние объекта.
        </div>
        <p>
          Создайте переход <code>hide</code> (Скрыть).
          В поле <b>Начальные состояние</b> выберите Ожидание и Опубликовано.
          В поле <b>Конечное состояние</b> выберите Скрытое.
        </p>
        <p>
          Создайте переход <code>moderate</code> (Модерировать), чтобы отправить комментарий на повторную проверку.
          Установите флажок <b>Пустое начальное состояние</b>.
          Этот переход будет доступен при отсутствии какого-либо состояния объекта.
          В поле <b>Начальные состояние</b> () выберите Скрытое.
          В поле <b>Конечное состояние</b> выберите Ожидание.
        </p>
        <p>
          Экспортируйте метаданные и перейдите в Офис. Создайте или откройте комментарий.
          На верхней панели формы комментария появятся кнопки переходов в зависимости от состояния объекта.
        </p>
      </div>
    </div>
  </article>

</div>
<footer class="footer footer-inverse">
  <div class="container mt20">
    <p class="text-center">Copyright @ 2022 Maxim Khorin</p>
  </div>
</footer>

<script src="../../vendor/jquery/jquery.min.js"></script>
<script src="../../vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../../vendor/highlight/highlight.pack.js"></script>
<script src="../../js/blog.js"></script>
<script src="../../js/common-ru.js"></script>
<script src="../../js/common.js"></script>

</body>
</html>