<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Дополнительные связи - Кинотеатр - Декларативный Node.js фреймворк Evado</title>
  <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico">
  <link rel="stylesheet" href="../../vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="../../vendor/highlight/styles/default.css">
  <link rel="stylesheet" href="../../css/common.css">
</head>

<body>
<div class="wrapper">
  <nav class="navbar navbar-inverse navbar-target"></nav>

  <article class="container">
    <div class="row">
      <div class="col-md-9">
        <h1>Дополнительные связи</h1>
        <h4>Класс Кинозал</h4>
        <p>
          Создайте вычисляемый атрибут <code>seatCounter</code> (Счетчик мест).
          Он посчитывает общее количество мест в зале.
          В поле <b>Вычисляемое выражение</b> укажите значение
          <code>["$query","count","seat",null,{"hall":".$key"}]</code> (подробнее смотри
          <a href="https://github.com/mkhorin/evado-meta-base/blob/master/calc/Calc.js" target="_blank">Calc</a>).
        </p>
        <p>
          Создайте атрибут множественная обратная ссылка <code>seats</code> (Места).
          Он отображает список мест в зале.
          В поле Ссылочный класс выберите <b>Место</b>.
          В поле Ссылочный атрибут выберите <b>Зал</b>.
          В этом атрибуте хранится связь между местом и кинозалом.
        </p>
        <p>
          Создайте атрибут множественная обратная ссылка <code>screenings</code> (Показы).
          Он отображает список показов фильмов в зале.
          В поле Ссылочный класс выберите <b>Показ</b>.
          В поле Ссылочный атрибут выберите <b>Зал</b>.
          В этом атрибуте хранится связь между показом и кинозалом.
        </p>
        <p>
          Создайте атрибут множественная обратная ссылка <code>prices</code> (Цены).
          Он отображает список ценообразований в зале.
          В поле Ссылочный класс выберите <b>Ценообразование</b>.
          В поле Ссылочный атрибут выберите <b>Зал</b>.
          В этом атрибуте хранится связь между ценообразованием и кинозалом.
        </p>

        <h4>Класс Фильм</h4>
        <p>
          Создайте атрибут обратную ссылку <code>screenings</code> (Показы).
          Он отображает список показов фильма.
          В поле Ссылочный класс выберите <b>Показ</b>.
          В поле Ссылочный атрибут выберите <b>Фильм</b>.
          В этом атрибуте хранится связь показа с фильмом.
        </p>
        <p>
          Создайте атрибут обратную ссылку <code>tickets</code> (Билеты).
          Он отображает список билетов на фильм.
          В поле Ссылочный класс выберите <b>Билет</b>.
          В поле Ссылочный атрибут выберите <b>Показ</b>.
          В этом атрибуте хранится связь билета с показом. Чтобы связать билет с фильмом, создайте
          промежуточную связь.
          В поле Ссылочный класс выберите <b>Показ</b>.
          В поле Ссылочный атрибут выберите <b>Фильм</b>.
        </p>
        <div class="alert-warning alert">
          Если ссылочный атрибут имеет промежуточную связь, то изменять значения через него нельзя.
          Установите флажок <b>Только чтение</b>.
        </div>
        <h4>Класс Ценообразование</h4>
        <p>
          Создайте атрибут обратную ссылку <code>prices</code> (Цены).
          Он отображает список специальных цен.
          В поле Ссылочный класс выберите <b>Цена места</b>.
          В поле Ссылочный атрибут выберите <b>Ценообразование</b>.
        </p>
        <h4>Класс Показ</h4>
        <p>
          Создайте атрибут обратную ссылку <code>tickets</code> (Билеты).
          Он отображает список билетов на показ.
          В поле Ссылочный класс выберите <b>Билет</b>.
          В поле Ссылочный атрибут выберите <b>Показ</b>.
        </p>
        <p>
          Создайте атрибут обратную ссылку <code>freeSeats</code> (Свободные места).
          Он отображает список свободных билетов на показ.
          В поле Ссылочный класс выберите <b>Билет</b>.
          Если отношение требует нестандартный функционал, то используйте поле <b>Фильтр</b>.
          Задайте конфигурацию, которая будет использован для выборки связанных объектов
          <code>{"Class":"component/meta/relation/FreeSeatsFilter"}</code>
          (<a href="https://github.com/mkhorin/evado-app-cinema/blob/master/component/meta/relation/FreeSeatsFilter.js" target="_blank">исходный код</a>).
        </p>
        <p>
          Экспортируйте метаданные и проверьте созданные отношения в Офисе.
        </p>
      </div>
    </div>
  </article>

</div>
<footer class="footer footer-inverse">
  <div class="container mt20">
    <p class="text-center">Copyright @ 2022 Maxim Khorin</p>
  </div>
</footer>

<script src="../../vendor/jquery/jquery.min.js"></script>
<script src="../../vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../../vendor/highlight/highlight.pack.js"></script>
<script src="../../js/cinema.js"></script>
<script src="../../js/common-ru.js"></script>
<script src="../../js/common.js"></script>

</body>
</html>